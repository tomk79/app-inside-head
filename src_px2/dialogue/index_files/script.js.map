{"version":3,"file":"dialogue/index_files/script.js","mappings":"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","sources":["webpack:///./dialogue/index_files/includes/Member.js","webpack:///./dialogue/index_files/includes/Committee.js","webpack:///./dialogue/index_files/script.js"],"sourcesContent":["class Member {\n\t#template = '';\n\n\tconstructor(options) {\n\t\tthis.#template = options.template || '';\n\t}\n\n\task (params) {\n\t\tconst message = this.#bindTemplate(params);\n\n\t\treturn new Promise((resolve, reject)=>{\n\t\t\t$.ajax({\n\t\t\t\t'url': './index_files/apis/query.php',\n\t\t\t\t\"type\": \"post\",\n\t\t\t\t\"dataType\": \"json\",\n\t\t\t\t\"data\": {\n\t\t\t\t\t\"content\": message,\n\t\t\t\t\t\"CSRF_TOKEN\": $('meta[name=csrf-token]').attr('content'),\n\t\t\t\t},\n\t\t\t\t\"async\": true,\n\t\t\t}).done((result)=>{\n\t\t\t\tresolve(result);\n\t\t\t}).fail((err)=>{\n\t\t\t\treject(err);\n\t\t\t});\n\t\t});\n\t}\n\n\t#bindTemplate (contents) {\n\t\tlet template = this.#template;\n\t\tif(!template){\n\t\t\ttemplate = '${mainTheme}';\n\t\t}\n\t\ttemplate = template.split('${mainTheme}').join(contents.mainTheme);\n\t\treturn template;\n\t}\n}\nexport default Member;\n","import Member from \"./Member\";\n\nclass Committee {\n\t#mainTheme;\n\t#currentIdea;\n\t#turnNumber = 0;\n\n\t#members;\n\n\t/**\n\t * Constructor\n\t */\n\tconstructor() {\n\t}\n\n\t/**\n\t * 初期化する\n\t */\n\tinit (params) {\n\t\tthis.#mainTheme = params.mainTheme;\n\t\tthis.#currentIdea = '';\n\t\tthis.#turnNumber = 0;\n\n\t\tthis.#members = {\n\t\t\tpresenter: new Member({\n\t\t\t\ttemplate: params.members.presenter.template || '',\n\t\t\t}),\n\t\t\treviewers: [],\n\t\t};\n\t\tparams.members.reviewers.forEach((member)=>{\n\t\t\tthis.#members.reviewers.push(new Member({\n\t\t\t\ttemplate: member.template || '',\n\t\t\t}));\n\t\t});\n\t}\n\n\t/**\n\t * ディスカッションを開始する\n\t */\n\tstartDiscussion () {\n\t\tthis.#idation();\n\t}\n\n\t#idation () {\n\t\tthis.#turnNumber ++;\n\t\tif( this.#turnNumber > 10 ){\n\t\t\tconsole.log('exit');\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#members.presenter.ask({\n\t\t\tmainTheme: this.#mainTheme,\n\t\t})\n\t\t\t.then((result)=>{\n\t\t\t\tconsole.log('#idation result:', result);\n\t\t\t\tthis.#currentIdea = result.choices[0].message.content;\n\t\t\t\tthis.#review();\n\t\t\t}).catch((err)=>{\n\t\t\t\tconsole.error(err);\n\t\t\t});\n\t\treturn;\n\t}\n\n\t#review () {\n\t\tlet reviewers = [];\n\t\tthis.#members.reviewers.forEach((reviewer)=>{\n\t\t\treviewers.push(reviewer.ask({\n\t\t\t\tmainTheme: this.#mainTheme,\n\t\t\t\tcurrentIdea: this.#currentIdea,\n\t\t\t}));\n\t\t});\n\t\treturn Promise.allSettled(reviewers)\n\t\t\t.then((result)=>{\n\t\t\t\tconsole.log('#review result:', result);\n\t\t\t\tthis.#idation();\n\t\t\t})\n\t\t\t.catch((err)=>{\n\t\t\t\tconsole.error(err);\n\t\t\t});\n\t}\n\n\t/**\n\t * ディスカッションを中止する\n\t */\n\tstopDiscussion () {\n\t}\n}\nexport default Committee;\n","import Committee from \"./includes/Committee\";\n\nconst committee = new Committee();\nlet csrfToken;\n\n$('#cont-btn-sendtest').on('click', ()=>{\n\tconst inputMainTheme = $('textarea[name=\"main-theme\"]').val();\n\n\tnew Promise((resolve, reject)=>{\n\t\tif(csrfToken){\n\t\t\tresolve(csrfToken);\n\t\t\treturn;\n\t\t}\n\t\twindow.getCsrfToken((result)=>{\n\t\t\tcsrfToken = result;\n\t\t\tresolve(csrfToken);\n\t\t\treturn;\n\t\t});\n\t}).then((csrfToken)=>{\n\t\treturn new Promise((resolve, reject)=>{\n\t\t\t$.ajax({\n\t\t\t\t'url': './index_files/apis/get_committee_settings.php',\n\t\t\t\t\"type\": \"get\",\n\t\t\t\t\"dataType\": \"json\",\n\t\t\t\t\"async\": true,\n\t\t\t}).done((result)=>{\n\t\t\t\tresolve(result.members);\n\t\t\t}).fail((err)=>{\n\t\t\t\tconsole.error(err);\n\t\t\t});\n\t\t});\n\n\t}).then((committeeInfo)=>{\n\t\tcommittee.init({\n\t\t\tmainTheme: inputMainTheme,\n\t\t\tmembers: committeeInfo,\n\t\t});\n\t\tcommittee.startDiscussion();\n\t});\n});"],"names":["_bindTemplate","contents","template","this","_template","split","join","mainTheme","Member","options","_classCallCheck","_Member_brand","_classPrivateFieldInitSpec","key","value","params","message","_assertClassBrand","call","Promise","resolve","reject","$","ajax","attr","done","result","fail","err","_mainTheme","WeakMap","_currentIdea","_turnNumber","_members","_Committee_brand","WeakSet","_idation","_this$turnNumber","_this2","_classPrivateFieldSet","_classPrivateFieldGet","console","log","presenter","ask","then","choices","content","_review","error","_this3","reviewers","forEach","reviewer","push","currentIdea","allSettled","csrfToken","committee","Committee","_this","members","member","on","inputMainTheme","val","window","getCsrfToken","committeeInfo","init","startDiscussion"],"sourceRoot":""}